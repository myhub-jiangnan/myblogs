

#  element 表单自定义验证



## html 部分
```
  <el-form :model="form" :rules="rules" ref="form" :hide-required-asterisk="true" label-width="0.8rem">
                <el-form-item label="账号" prop="accountName">
                    <el-input v-model="form.accountName" placeholder="支持中文汉字、数字、英文字母" maxlength="8"></el-input>
                </el-form-item>
                <el-form-item label="手机号" prop="phoneNum" :error="phoneError">
                    <el-input v-model="form.phoneNum" placeholder="请输入手机号" maxlength="11"></el-input>
                </el-form-item>
                <el-form-item label="验证码" prop="VerificationCode">
                    <el-input v-model="form.VerificationCode" placeholder="请输入验证码" maxlength="4"></el-input>
                    <div class="verifiCode_btn" @click="send" :disabled="disabled=!show">
                        <span v-show="show">获取验证码</span>
                        <span v-show="!show">{{count}} s</span>
                    </div>
                </el-form-item>
                <el-form-item label="密码" prop="password">
                    <el-input type="password" v-model="form.password" placeholder="仅支持数字、英文字母和下划线"></el-input>
                </el-form-item>
                <el-form-item label="重复密码" prop="comfirmPassWord">
                    <el-input type="password" v-model="form.comfirmPassWord" placeholder="仅支持数字、英文字母和下划线"></el-input>
                </el-form-item>
                <el-form-item label="姓名" prop="userName">
                    <el-input v-model="form.userName" placeholder="请输入您的姓名" maxlength="8"></el-input>
                </el-form-item>
            </el-form>

```  


## JavaScript 部分(vue)


``` 
  // 引入表单验证函数
 import verification from "@/plugin/rules"
export default {

data() {
  let comfirmPassWord = (rule, value, callback) => {
                if (!value) {
                    return callback(new Error('请再次输入密码'));
                } else {
                    // callback()
                    if (value !== that.form.password) {
                        callback(new Error("两次输入的密码不一致"))
                    } else {
                        callback()
                    }
                }
            }
            return {

                labelPosition: "right",
                form: {
                    accountName: "",
                    phoneNum: "",
                    VerificationCode: "",
                    password: "",
                    comfirmPassWord: "",
                    userName: ""
                },
                // 校验字段
                rules: {
                    accountName: [{
                        validator: verification.accountName,
                        trigger: 'blur'
                    }],
                    phoneNum: [{
                        validator: verification.mobileRules,
                        trigger: 'blur'
                    }],
                    VerificationCode: [{
                        validator: verification.verifyCodeRules,
                        trigger: 'blur'
                    }],
                    password: [{
                        validator: verification.psRules,
                        trigger: 'blur'
                    }],
                    comfirmPassWord: [{
                        validator: comfirmPassWord,
                        trigger: 'blur'
                    }],
                    userName: [{
                        validator: verification.nameRules,
                        trigger: 'blur'
                    }]
                },
                // 获取验证码
                TIME_COUNT: 60, //更改倒计时时间
                show: true, // 初始启用按钮
                count: '', // 初始化次数
                timer: null,
                // 手机号为空时，的提示信息
                phoneError: ""

            };
        },



},

methods:{
   // 发送验证码
            send() {
                if (!this.form.phoneNum) {
                    this.phoneError = "手机号不能为空"
                    return
                } else {
                    let mobileReg = /^[1][3,4,5,7,8][0-9]{9}$/;
                    if (!mobileReg.test(this.form.phoneNum)) {
                        alert("请输入正确的手机号！")
                        return
                    } else {
                        if (this.TIME_COUNT == 60) {
                            // 获取手机验证码：
                            registrationCode({
                                phone: this.form.phoneNum
                            }).then(res => {
                                if (res.data.errorCode == 4) {
                                    alert("该手机号未与平台绑定")
                                    return
                                } else if (res.data.errorCode == 109) {
                                    alert("验证码发送发送过于频繁,请10分钟后再试！")
                                } else {
                                    if (!this.timer) {
                                        this.count = this.TIME_COUNT;
                                        this.show = false;
                                        this.timer = setInterval(() => {
                                            if (this.count > 0 && this.count <= this
                                                .TIME_COUNT) {
                                                this.count--;
                                            } else {
                                                this.show = true;
                                                clearInterval(this.timer); // 清除定时器
                                                this.timer = null;
                                            }
                                        }, 1000)
                                    }

                                }
                            })
                        }
                    }

                }


            },
            submit() {
                // 提交
                this.$refs.form.validate(valid => {
                    if (valid) {
                        registrationUserAdd({
                            account: this.form.accountName,
                            phone: this.form.phoneNum,
                            code: this.form.VerificationCode,
                            password: this.form.password,
                            userType: 1,
                            userName: this.form.userName
                            // account: "江南",
                            // phone: 18302124764,
                            // code: 1234,
                            // password: "Jn123456",
                            // userType: 1,
                            // userName: "江南"
                        }).then(res => {
                            alert(res.data.result);
                            if (res.data.success) {
                                this.$router.go(-1)
                            } else {
                                this.$refs.form.resetFields()
                            }
                        })
                    }
                })
            },

}





}

```


## css 部分

```

 .el-form {
                // border: 1px solid red;
                margin-top: 0.2rem;
                position: relative;

                /deep/ .el-form-item__label {
                    // border: 1px solid red;
                    padding-right: 0.2rem !important;
                    line-height: 0.4rem;
                }

                .el-form-item {
                    // border: 1px solid blue;
                    position: relative;
                    margin-bottom: 0.35rem !important;
                    white-space: nowrap;
                    height: 0.4rem;
                    white-space: wrap !important;

                    /deep/ .el-form-item__content {
                        // border: 1px solid red;
                        height: 100%;
                        line-height: 0.4rem !important;
                        // color: red !important;
                    }

                    /deep/ .el-input {
                        // border: 1px solid red;
                        height: 100% !important;
                    }

                    /deep/ .el-input__inner {
                        // border: 1px solid red !important;
                        height: 100% !important;
                        line-height: 0.4rem !important;
                    }

                    /deep/ .el-textarea__inner {
                        height: 100%;
                        padding: 0;
                        border: none;
                    }

                    /deep/ .el-form-item__error {
                        // color: black;
                        // border: 1px solid red;
                        width: 100%;
                        word-break: break-all;
                        white-space: normal !important;
                        font-size: 0.13rem;
                        margin-bottom: 0.1rem !important;
                        padding-bottom: 0.1rem;
                    }

                    .verifiCode_btn {
                        // border: 1px solid red;
                        position: absolute;
                        color: #FC971E;
                        right: 9%;
                        top: 0;
                        bottom: 0;
                        margin: auto;
                        font-size: 0.16rem;
                        height: 0.4rem;
                        line-height: 0.4rem;

                    }
                }
            }



```
